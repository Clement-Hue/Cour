---
title: "tp1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("kmeans_cah_acp.r")
```


A) Préparation des donnée

On remplace les valeurs "-" par NA et on supprime les NA
On supprime ensuite toute les lignes contenant "<"
## R Markdown
```{r}
data <- read.csv("Ciqual2017Boissons.csv", na = '-')
data <- na.omit(data)
data <- data[!grepl("<", data$Protéines..g.100g.),]
rownames(data) <- data[,1] 
data[,1] <- NULL
for (i in names(data)){
  data[,i] <- as.numeric(sub(",", ".", data[,i], fixed = TRUE))
}
```

B Question général

B&)
On remarque que l'énergie d'une boisson est fortement corrélé à la présence d'eea,
plus il y a d'eau, moins la boisson est énergétique. Il y a également une corrélation entre
la quantité d'alcool et l'énergie de la boisson, plus il y'a d'alcool, plus la boisson
est énergétique, d'ailleurs, moins il y a d'eau, plus il y a d'alcool.
Parcontre la présence de sucre ou glucide n'influe pas tant que ça sur l'énergie
, et la présence de glucide est essentiellement dù à la présence de sucre. Pour finir une boisson 
énergétique est une boisson qui a tendance a avoir moins de protéines.

```{r}
# moyenne
colMeans(data)
# variance
kvariance(data)
# corélation
cor(data)
```

B2)

On utilise la distance euclidienne car se sont des variables quantitatives

```{r}
distance <- as.matrix(dist(data, method="euclidean"))
distance
```

Partie ACP

C1) On interpréte les 2 premiers axes car ils détiennent la majortié de l'information (on observe
cela en faisant un plot de l'acp, ces 2 axes représentent 75% d'après le tableau des pourcentages cumulés). De plus si on suit le critère de Kaiser, l'axe 1 et 2 sont les seuls ayant une 
inertie supérieur à 1

C2)
```{r}

# graph de l'acp
 acp <- ACPN(data)
biplot(acp)

# Coordonnée des individus sur les 2 axes principaux
acp$scores[,1:2]

# Corrélation des variables avec les 2 principaux axes de l'acp
AXEVARk(data, acp,2)

# part d'inertie des individus sur les 2 principaux axes
CTR(acp,2)

# cos²(teta) des individus sur les axes
COS2TETA(acp, 2)
```

C3)
Analyse des variables:
L'eau et l'énergie participent le plus à la formation de l'axe 1.
Le sucre, glucide, cendre et alcool pour l'axe 2.

Analyse des individus:
Les individus typiques de l'axe 1 sont la liqueur et la crème de cassis,
ceux de l'axe 2 sont le pastis, le Gin, et le Rhum.
le Kir (au vin blanc) et le Kir royal sont mal représentés que ce soit sur l'axe 1 ou 2 d'après la valeur du cosinus carré de l'angle teta.

On peut en déduire que la liqueur et la crème de cassis sont fortement caractérisé par les
variables eau et énergie, et le pastis, gin et Rhum sont fortement caractérisé par le succre,
glucide, cendre et alcool

C4)
Sur le plan factoriel représenté par l'axe 2 et 3, on remarque que le sel de chlorure
de sodium est la variable prinicpal de l'axe 3.
Pour ce qui est des individus, c'est principalement le cocktail à base de whisky
qui est l'individu typique de l'axe 3
On en conclut que le cocktail à base de whisky est essentielelment composé de sel de 
chlorure de sodium


```{r}
# plan facotriel: axe 2 et 3
PLAN(acp, 2,3)
AXEVARk(data, acp,3)
CTR(acp,3)
```

D1)
```{r}

single <- function(T) {
	N <- nrow(T);
	T1 <- scale(T);		# pour centrer r?duire uniquement
	T1 <- T1*sqrt(N/(N-1));	# pour centrer r?duire uniquement
	D <- dist(T1,method="euclidean");
	D <- D^2/(2*N); # mise en place de la distance entre classes
        R <- hclust(D,method="single");
        return(R)}

# cah ward
cah <- ward(data)
```

C2) 
On remarque que pour le single linkage il y'a trois principal classes, dont 2 ne contenant
qu'un seul individiu. Alors que pour la méthode de ward, il y a 2 principal classes, plutot
bien répartie.
````{r}
# cah single linkage
single_linkage <- single(data)
plot(cah,hang=-1)
plot(single_linkage,hang=-1)
```

C3) 
Nous allons analyser 2 partitions: la partition en 2 classes et la partition en 4 classes
Partition en 2 classes:
rapport d'inertie expliqué: 34.9%

Partition en 4 classes:
rapport d'inertie expliqué:  70.9%

```{r}
"répératition des individus dans la partition à 4 classes"
couper(cah,4)

"rapport d'inertie expliquée, partition en 4 classes"
rap_inertie(cah, 4)

"pouvoir discirminant des variables, partition en 4 classes"
pdis(data, cah, 4)

"excentricité des classes, partition en 4 classes"
rho2(data, cah, 4)

"centre de gravité des classes, partition en 4 classes"
cdgcl(data, cah, 4)

"contribution des variables à l'inertie des clsses, partition en 4 classes"
ctrcl(data, cah, 4)

"rapport d'inertie explique, partition en 2 classes"
rap_inertie(cah, 2)

```

D4)
les variables caractérisant la partitions sont l'énegie, l'eau, le scure, le glucide et l'alcool

classe 1: Cette classe regroupe le vin doux, cocktail à base de whisky. Elle est caractérisé par la quantité de cendre et de sel de chlorure de sodium pour 100g.

classe 2: Cette classe regroupe: Pétaillant de fruit, les vins blancs, les vins rouges,
champagne, les bières, sangria, les kirs, cocktail sans alcool, saké et les panachés.
Elle est caractérisé par la quantité d'eau pour 100g

classe 3: Cette classe regroupe: le pastis, l'eau de vie, le Gin, le rhum, le whisky et la vodka, ce sont essentiellement les boissons les plus alcoolisés. Elle est caractérisé par l'énergie, et la présence d'alcool pour 100g

classe 4: Cette classe regroupe: la liqueur, les cocktails à base de rhum, la marsola et la crème de cassis, ce sont les boissons les plus sucrés. Elle est caractérisé par la quantité de sucre et glucide pour 100g.


Conclusion:
